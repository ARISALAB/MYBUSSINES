<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Καταγραφή Ραντεβού</title>
    <link rel="stylesheet" href="styles.css"> <!-- Σύνδεσμος στο αρχείο CSS -->
    <link rel="icon" href="11.png" type="image/png">
</head>
<body>

    <nav>
        <img src="11.png" alt="Logo" class="logo">
        <button class="menu-toggle">&#9776;<br>Menu</button>
        <div class="menu-items">
            <a href="index.html">Αρχική Σελίδα</a>
            <a href="appointments.html">Καταγραφή Ραντεβού</a> <!-- Προσθήκη νέας επιλογής -->
        </div>
    </nav>

    <h1>Καταγραφή Ραντεβού</h1>

    <!-- Επιλογή ημερομηνίας -->
    <label for="appointment-date">Επιλέξτε Ημερομηνία:</label>
    <input type="date" id="appointment-date" required>

    <!-- Φόρμα για προσθήκη ραντεβού -->
    <form id="appointment-form">
        <label for="customer-name">Όνομα Πελάτη</label>
        <input type="text" id="customer-name" required>

        <label for="customer-surname">Επώνυμο Πελάτη</label>
        <input type="text" id="customer-surname" required>

        <label for="appointment-time">Ώρα Ραντεβού</label>
        <input type="time" id="appointment-time" required>

        <input type="submit" value="Προσθήκη Ραντεβού">
    </form>

    <!-- Πίνακας για εμφάνιση των ραντεβού -->
    <table id="appointments-table" style="display: none;">
        <thead>
            <tr>
                <th>Όνομα</th>
                <th>Επώνυμο</th>
                <th>Ώρα Ραντεβού</th>
                <th>Ενέργειες</th>
            </tr>
        </thead>
        <tbody id="appointments-list"></tbody>
    </table>

    <footer>&copy; 2024 Καταγραφή Ραντεβού</footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const appointmentForm = document.getElementById('appointment-form');
            const customerNameInput = document.getElementById('customer-name');
            const customerSurnameInput = document.getElementById('customer-surname');
            const appointmentTimeInput = document.getElementById('appointment-time');
            const appointmentsList = document.getElementById('appointments-list');
            const appointmentsTable = document.getElementById('appointments-table');
            const appointmentDateInput = document.getElementById('appointment-date');

            // Ανάκτηση των ραντεβού από το localStorage
            const appointments = JSON.parse(localStorage.getItem('appointments')) || {};

            // Λειτουργία για την αποθήκευση των ραντεβού
            function saveAppointments() {
                localStorage.setItem('appointments', JSON.stringify(appointments));
            }

            // Απόδοση των ραντεβού για τη συγκεκριμένη ημερομηνία
            function renderAppointmentsForDate(date) {
                const appointmentsForDate = appointments[date] || [];
                appointmentsList.innerHTML = '';
                appointmentsForDate.sort((a, b) => a.time.localeCompare(b.time)); // Ταξινόμηση κατά ώρα

                appointmentsForDate.forEach((appointment, index) => {
                    const appointmentItem = document.createElement('tr');
                    appointmentItem.innerHTML = `
                        <td>${appointment.name}</td>
                        <td>${appointment.surname}</td>
                        <td>${appointment.time}</td>
                        <td>
                            <button class="edit-btn" data-index="${index}">Επεξεργασία</button>
                            <button class="delete-btn" data-index="${index}">Διαγραφή</button>
                        </td>
                    `;

                    appointmentItem.querySelector('.edit-btn').addEventListener('click', (e) => editAppointment(date, e.target.dataset.index));
                    appointmentItem.querySelector('.delete-btn').addEventListener('click', (e) => deleteAppointment(date, e.target.dataset.index));

                    appointmentsList.appendChild(appointmentItem);
                });

                appointmentsTable.style.display = appointmentsForDate.length > 0 ? 'table' : 'none'; // Εμφάνιση πίνακα αν υπάρχουν ραντεβού
            }

            // Προσθήκη νέου ραντεβού
            function addAppointment(e) {
                e.preventDefault();

                const name = customerNameInput.value.trim();
                const surname = customerSurnameInput.value.trim();
                const time = appointmentTimeInput.value.trim();
                const date = appointmentDateInput.value;

                if (!name || !surname || !time || !date) {
                    alert('Παρακαλώ συμπληρώστε όλα τα πεδία.');
                    return;
                }

                if (!appointments[date]) {
                    appointments[date] = [];
                }

                appointments[date].push({ name, surname, time });
                saveAppointments();
                renderAppointmentsForDate(date);
                appointmentForm.reset();
            }

            // Επεξεργασία ραντεβού
            function editAppointment(date, index) {
                const appointment = appointments[date][index];
                customerNameInput.value = appointment.name;
                customerSurnameInput.value = appointment.surname;
                appointmentTimeInput.value = appointment.time;

                deleteAppointment(date, index);
            }

            // Διαγραφή ραντεβού
            function deleteAppointment(date, index) {
                appointments[date].splice(index, 1);
                if (appointments[date].length === 0) {
                    delete appointments[date];
                }
                saveAppointments();
                renderAppointmentsForDate(date);
            }

            // Εκκίνηση της εφαρμογής
            appointmentForm.addEventListener('submit', addAppointment);
            appointmentDateInput.addEventListener('change', () => {
                const selectedDate = appointmentDateInput.value;
                renderAppointmentsForDate(selectedDate);
            });

            // Εμφάνιση των ραντεβού για την αρχική ημερομηνία
            renderAppointmentsForDate(appointmentDateInput.value);
        });
    </script>

    <script>
        document.querySelector('.menu-toggle').addEventListener('click', function() {
            document.getElementById('menuModal').style.display = 'flex';
        });

        document.querySelector('.close').addEventListener('click', function() {
            document.getElementById('menuModal').style.display = 'none';
        });
        
        window.onclick = function(event) {
            if (event.target == document.getElementById('menuModal')) {
                document.getElementById('menuModal').style.display = 'none';
            }
        };
    </script>
</body>
</html>
